{% extends "base.html" %}

        <script src='{{ url_for('static',filename='js/jquery-1.12.0.min.js')}}'></script>

{% block content %}
        
        <script>
            $(document).ready(function(){
            
                $('#filterselect').on('change', function() {
                  if ( this.value == 'WFC3_IR.G102' || this.value == 'WFC3_IR.G141' || this.value == 'NIRISS.GR700XD.1'  || this.value == 'STIS.G430L'  || this.value == 'STIS.G750L')
                  {
                      $("#n_bins").show();
                      $("#or").show()
                      $("#and").hide()
                  } 
                  else if ( this.value == 'tophat' )
                  {
                      $("#n_bins").show()
                      $("#and").show()
                      $("#or").hide()
                  }
                  else
                  {
                    $("#n_bins").hide();
                  }
                });
                
            });
        </script>

        <div class='form-group'>
            <h1>Limb Darkening Calculator</h1>
            <br>
            <p>

            The Limb Darkening Calculator calculates limb-darkening coefficients for a specified stellar model, plotting results versus intensity ratio and wavelength. It uses high
            spectral resolution stellar atmospheric models, which are a neccesisty given JWST's expected precision. 
            </p>

            <form class='form-horizontal' id='searchform' method='POST', novalidate>
                {{ form.hidden_tag() }}

                <hr class="col-md-12">
                <div class='form-group'>

                    <label for='' class="col-sm-2 control-label">Specify the Stellar Parameters</label>
                    <div class="col-sm-10">


                        <div class="input-group">
                            {{ form.targname(size=32, placeholder="WASP-18 b") }}<br>
                        </div>
                        <span id="helpBlock" class="help-block">The name of a target to resolve in ExoMAST</span>
                        <div class="input-group">
                            {{ form.resolve_submit(class="btn btn-success") }}
                        </div>
                        <br>
                        <span id="helpBlock" class="help-block">Or enter parameters manually</span>
                        <br>

                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>\(T_\text{eff}\)</div>
                          {{ form.teff(value=form.teff.data, size=10, placeholder="2300 - 7800", rows=1, class='form-control') }}
                          <div class="input-group-addon" style='width:60px'>K</div>
                        </div>
                        <span id="helpBlock" class="help-block">The stellar effective temperature</span>
                        {% for error in form.teff.errors %}
                        <span style="color: red;">{{ error }}</span>
                        {% endfor %}
                        <br>
                        <br>

                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>\(\log (g)\)</div>
                          {{ form.logg(value=form.logg.data, size=10, placeholder="3 - 6", rows=1, class='form-control') }}
                          <div class="input-group-addon" style='width:60px'>dex</div>
                        </div>
                        <span id="helpBlock" class="help-block">The logarithm of the stellar surface gravity</span>
                        {% for error in form.logg.errors %}
                        <span style="color: red;">{{ error }}</span>
                        {% endfor %}
                        <br>
                        <br>

                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>\([\text{Fe}/\text{H}]\)</div>
                          {{ form.logg(value=form.feh.data, size=10, placeholder="-0.5 - +0.5", rows=1, class='form-control') }}
                          <div class="input-group-addon" style='width:60px'>dex</div>
                        </div>
                        <span id="helpBlock" class="help-block">The logarithm of the stellar metallicity</span>
                        {% for error in form.feh.errors %}
                        <span style="color: red;">{{ error }}</span>
                        {% endfor %}
                        <br>
                        <br>

                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>Minimum \(\mu\)</div>
                          {{ form.mu_min(size=10, placeholder="0 - 1", rows=1, class='form-control') }}
                          <div class="input-group-addon" style='width:60px'></div>
                        </div>
                        <span id="helpBlock" class="help-block">The minimum angle to consider when fitting the LD profile</span>
                        {% for error in form.mu_min.errors %}
                        <span style="color: red;">{{ error }}</span>
                        {% endfor %}
                        <br>
                    </div>
                </div>

                <hr class="col-md-12">
                <div class='form-group'>
                    <label for="modeldir" class="col-sm-2 control-label">Choose a Model Grid</label>
                    <div class="col-sm-10">
                        {% for subfield in form.modeldir %}
                            <div class='radio'>
                                {{ subfield(style='margin-left:0px;') }}{{ subfield.label }}
                            </div>
                        {% endfor %}
                    </div>
                    {% for error in form.modeldir.errors %}
                    <span style="color: red;">{{ error }}</span>
                    {% endfor %}
                </div>

                <hr class="col-md-12">
                <div class='form-group'>
                    
                    <label for="bandpass" class="col-sm-2 control-label">Choose a Bandpass</label>
                    <div class="col-sm-10">
                        <select class='form-control' name="bandpass" id="filterselect">
                            {% for option in form.bandpass %}
                                <div class='radio'>
                                    {{ option }}
                                </div>
                            {% endfor %}
                        </select>
                    </div>
                    {% for error in form.bandpass.errors %}
                    <span style="color: red;">{{ error }}</span>
                    {% endfor %}
                </div>
                
                <br>
                
                <div id='n_bins' class='form-group', style='display:none;'>
                    
                    <label for='' class="col-sm-2 control-label">Grism Details</label>
                    <div class="col-sm-10">                        
                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>\(\lambda_\text{min}\)</div>
                          <input id='wave_min' type="text" class='form-control' name="wave_min" size="10" rows="1" value="" placeholder=""/>
                          <div class="input-group-addon" style='width:60px'>\(\mu\)m</div>
                        </div>
                        <span id="helpBlock" class="help-block">The minimum wavelength of the grism to use</span>
                        
                        <br>

                        <div class="input-group">
                          <div class="input-group-addon" style='width:120px'>\(\lambda_\text{max}\)</div>
                          <input id='wave_max' type="text" class='form-control' name="wave_max" size="10" rows="1" value="" placeholder=""/>
                          <div class="input-group-addon" style='width:60px'>\(\mu\)m</div>
                        </div>
                        <span id="helpBlock" class="help-block">The maximum wavelength of the grism to use</span>
                        
                        <br>

                        <div class="form-inline">
                            <div class="input-group col-sm-4"> 
                                <div class="input-group">
                                  <div class="input-group-addon" style='width:120px'># channels</div>
                                  <input id='n_bins' type="text" class='form-control' name="n_bins" size="10" rows="1" value="" placeholder=""/>
                                </div>
                                <span id="helpBlock" class="help-block">The number of channel to split the grism into</span>
                            </div>
                            
                            <div class="input-group col-sm-1"> 
                                <strong><span id='and'>AND</span><span id='or' style='display:none;'>OR</span></strong>
                            </div>
                            
                            <div class="input-group col-sm-4">
                                <div class="input-group"> 
                                  <div class="input-group-addon" style='width:120px'># pix/channel</div>
                                  <input id='pixels_per_bin' type="text" class='form-control' name="pixels_per_bin" size="10" rows="1" value="" placeholder=""/>
                                 </div>
                                  <span id="helpBlock" class="help-block">The number of pixels in each grism channel</span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <hr class="col-md-12">
                <div class='form-group'>
                    <label class="col-sm-2 control-label">Choose One or More Limb Darkening Profiles</label>
                    <div class="col-sm-10">
                        <div>
                            {% for box in form.profiles %}
                                <div class='radio'>
                                    {{ box(style='margin-right:-10px;') }}{{ box.label }}
                                </div>
                            {% endfor %}
                        </div>
                        <br>
                        {% for error in form.profiles.errors %}
                        <span style="color: red;">{{ error }}</span>
                        {% endfor %}
                    </div>
                </div>
                
                <hr class="col-md-12">
                <div class='form-group'>
                    <label for='submit' class="col-sm-2 control-label">Submit!</label>
                    <div class="col-sm-10">
                        <p>
                            {{ form.calculate_submit(class="btn btn-success") }}
                            <span id="helpBlock" class="help-block">This can take up to 20 seconds! Please be patient.</span>
                        </p>
                    </div>
                </div>
            
            </form>

        </div>

{% endblock %}
